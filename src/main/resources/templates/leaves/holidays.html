<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/head :: head('Holiday Calendar')}"></head>

<body>
    <!-- Top Navbar Fragment -->
    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <main class="main-container">
        <header class="page-header">
            <div>
                <h1 class="page-title">Holiday Calendar</h1>
                <p class="page-subtitle">Official company holidays for the current year</p>
            </div>
            <a href="/leaves" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Leaves
            </a>
        </header>

        <div style="max-width: 960px; margin: 0 auto;">

            <!-- ====== ADMIN: Add Holiday Form (visible only to admins) ====== -->
            <div th:if="${userEmployee != null and userEmployee.role == 'ROLE_ADMIN'}" style="background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
                        border-radius: 18px; padding: 2rem; margin-bottom: 2rem;
                        box-shadow: 0 8px 24px rgba(79,70,229,0.18);">
                <h2 style="color: white; font-size: 1.1rem; font-weight: 700; margin: 0 0 1.25rem;
                            display: flex; align-items: center; gap: 0.6rem;">
                    <i class="fas fa-calendar-plus"></i> Add New Holiday
                </h2>
                <form th:action="@{/leaves/holidays/save}" method="post" th:object="${newHoliday}"
                    style="display: flex; gap: 1rem; align-items: flex-end; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 160px;">
                        <label style="display: block; color: rgba(255,255,255,0.8);
                                      font-size: 0.75rem; font-weight: 600; margin-bottom: 0.4rem;
                                      text-transform: uppercase; letter-spacing: 0.05em;">
                            Holiday Date
                        </label>
                        <input type="date" th:field="*{holidayDate}" required style="width: 100%; padding: 0.65rem 0.9rem; border-radius: 10px;
                                      border: 1px solid rgba(255,255,255,0.3);
                                      background: rgba(255,255,255,0.12); color: white;
                                      font-size: 0.9rem; outline: none;">
                    </div>
                    <div style="flex: 2; min-width: 220px;">
                        <label style="display: block; color: rgba(255,255,255,0.8);
                                      font-size: 0.75rem; font-weight: 600; margin-bottom: 0.4rem;
                                      text-transform: uppercase; letter-spacing: 0.05em;">
                            Holiday Name / Description
                        </label>
                        <input type="text" th:field="*{description}" placeholder="e.g. Independence Day" required style="width: 100%; padding: 0.65rem 0.9rem; border-radius: 10px;
                                      border: 1px solid rgba(255,255,255,0.3);
                                      background: rgba(255,255,255,0.12); color: white;
                                      font-size: 0.9rem; outline: none;">
                    </div>
                    <button type="submit" style="padding: 0.65rem 1.5rem; border-radius: 10px;
                                   background: white; color: #4f46e5; border: none;
                                   font-weight: 700; font-size: 0.9rem; cursor: pointer;
                                   display: flex; align-items: center; gap: 0.5rem;
                                   white-space: nowrap; transition: all 0.2s;">
                        <i class="fas fa-save"></i> Save Holiday
                    </button>
                </form>
            </div>
            <!-- ====== END ADMIN FORM ====== -->

            <div class="card" style="padding: 0; overflow: hidden;">
                <!-- Modern Gradient Banner -->
                <div style="background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
                             padding: 2.5rem; color: white; display: flex; align-items: center;
                             gap: 1.5rem; flex-wrap: wrap;">
                    <div style="width: 60px; height: 60px; background: rgba(255,255,255,0.15);
                                 backdrop-filter: blur(8px); border: 1px solid rgba(255,255,255,0.2);
                                 border-radius: 16px; display: flex; align-items: center;
                                 justify-content: center; font-size: 1.75rem;
                                 box-shadow: 0 10px 20px rgba(0,0,0,0.1); flex-shrink: 0;">
                        <i class="fas fa-umbrella-beach"></i>
                    </div>
                    <div style="flex: 1; min-width: 200px;">
                        <h2 style="font-size: 1.5rem; font-weight: 700; margin: 0; letter-spacing: -0.025em;">
                            Corporate Holidays 2026</h2>
                        <p
                            style="margin: 0.5rem 0 0; opacity: 0.9; font-size: 0.9rem; font-weight: 400; line-height: 1.4;">
                            Plan your well-deserved breaks around these scheduled dates.</p>
                    </div>
                </div>

                <!-- Data Table -->
                <div class="table-container" style="padding: 1.5rem;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="padding-left: 1.5rem;">Occasion / Holiday</th>
                                <th>Date</th>
                                <th>Weekday</th>
                                <!-- Admin-only Actions column header -->
                                <th th:if="${userEmployee != null and userEmployee.role == 'ROLE_ADMIN'}"
                                    style="text-align: right; padding-right: 1.5rem;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="holiday : ${holidays}">
                                <td style="padding-left: 1.5rem;">
                                    <div style="display: flex; align-items: center; gap: 1rem;">
                                        <div
                                            style="width: 10px; height: 10px; border-radius: 50%; background: var(--secondary);">
                                        </div>
                                        <span style="font-weight: 700; color: var(--text);"
                                            th:text="${holiday.description}">New Year's Day</span>
                                    </div>
                                </td>
                                <td>
                                    <div
                                        style="display: flex; align-items: center; gap: 0.75rem; color: var(--text-dark); font-weight: 500;">
                                        <i class="far fa-calendar-alt"
                                            style="color: var(--primary); font-size: 1.1rem;"></i>
                                        <span th:text="${#temporals.format(holiday.holidayDate, 'dd MMMM yyyy')}">01 Jan
                                            2026</span>
                                    </div>
                                </td>
                                <td style="color: var(--text-muted); font-weight: 600; font-size: 0.85rem;
                                           text-transform: uppercase; letter-spacing: 0.05em;"
                                    th:text="${#temporals.format(holiday.holidayDate, 'EEEE')}">Monday</td>

                                <!-- Admin-only: Delete button per row -->
                                <td th:if="${userEmployee != null and userEmployee.role == 'ROLE_ADMIN'}"
                                    style="text-align: right; padding-right: 1.5rem;">
                                    <form th:action="@{/leaves/holidays/delete/{id}(id=${holiday.holidayId})}"
                                        method="post"
                                        onsubmit="return confirm('Remove this holiday from the calendar?')">
                                        <button type="submit" style="padding: 0.35rem 0.8rem; border-radius: 8px;
                                                       background: #fff5f5; color: #ef4444;
                                                       border: 1px solid #fee2e2; font-size: 0.75rem;
                                                       font-weight: 700; cursor: pointer; transition: all 0.2s;">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            <tr th:if="${#lists.isEmpty(holidays)}">
                                <td colspan="4" style="text-align: center; padding: 5rem 2rem;">
                                    <div style="font-size: 4rem; color: #f1f5f9; margin-bottom: 1.5rem;">
                                        <i class="fas fa-calendar-times"></i>
                                    </div>
                                    <h4 style="color: var(--text); font-weight: 700; font-size: 1.1rem;">Calendar Empty
                                    </h4>
                                    <p
                                        style="color: var(--text-muted); font-size: 0.9rem; max-width: 300px; margin: 0.5rem auto 0;">
                                        No holidays have been scheduled for this period yet.</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Info Card -->
            <div style="margin-top: 2rem; background: #f8fafc; padding: 1.5rem; border-radius: 18px;
                         border: 1px solid var(--border); display: flex; align-items: flex-start; gap: 1.25rem;">
                <div style="width: 40px; height: 40px; background: white; color: var(--primary); border-radius: 12px;
                             display: flex; align-items: center; justify-content: center; font-size: 1.1rem;
                             box-shadow: 0 4px 10px rgba(0,0,0,0.03); flex-shrink: 0;">
                    <i class="fas fa-info-circle"></i>
                </div>
                <p style="margin: 0; color: var(--text-muted); font-size: 0.875rem; line-height: 1.6;">
                    Holiday dates are governed by statutory regulations and corporate policy. These dates are
                    automatically excluded when calculating leave duration for your applications.
                </p>
            </div>
        </div>
    </main>
</body>

</html>